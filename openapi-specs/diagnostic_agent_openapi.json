{
  "openapi": "3.0.3",
  "info": {
    "title": "Flock Diagnostic API",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "https://YOUR_APIM_NAME.azure-api.net/flockcopilot"
    }
  ],
  "paths": {
    "/api/anomalies": {
      "get": {
        "operationId": "GetAnomalies",
        "summary": "Get recent anomalies (tenant-scoped)",
        "parameters": [
          {
            "name": "X-Tenant-Id-Claim",
            "in": "header",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Tenant identifier (simulates a claim)."
          },
          {
            "name": "window",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "48h"
            },
            "description": "Lookback window such as 48h or 7d. Defaults to 48h."
          },
          {
            "name": "flockId",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Optional flock/building id filter (e.g. building-a)."
          }
        ],
        "responses": {
          "200": {
            "description": "Recent anomaly records."
          }
        }
      }
    },
    "/api/flocks/{flockId}/performance": {
      "get": {
        "operationId": "GetFlockPerformance",
        "summary": "Get latest flock performance snapshot",
        "parameters": [
          {
            "name": "X-Tenant-Id-Claim",
            "in": "header",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Tenant identifier (simulates a claim)."
          },
          {
            "name": "flockId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Target flock identifier."
          }
        ],
        "responses": {
          "200": {
            "description": "Normalized flock performance record.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NormalizedFlockPerformance"
                }
              }
            }
          }
        }
      }
    },
    "/api/flocks/{flockId}/history": {
      "get": {
        "operationId": "GetFlockHistory",
        "summary": "Get historical flock performance data",
        "parameters": [
          {
            "name": "X-Tenant-Id-Claim",
            "in": "header",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Tenant identifier (simulates a claim)."
          },
          {
            "name": "flockId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Target flock identifier."
          },
          {
            "name": "window",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "7d"
            },
            "description": "Lookback window such as 7d, 30d, or 72h."
          }
        ],
        "responses": {
          "200": {
            "description": "Chronological list of normalized flock data.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/NormalizedFlockPerformance"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "NormalizedFlockPerformance": {
        "type": "object",
        "description": "Normalized telemetry snapshot. Fields vary by ingestion.",
        "additionalProperties": true
      }
    }
  }
}
